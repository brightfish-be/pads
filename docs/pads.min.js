!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Pad=t()}(this,function(){"use strict";"function"!=typeof Object.assign&&(Object.assign=function(e,t){var i,n,a,r,s=arguments.length;if(!e)throw new TypeError("Cannot convert undefined or null to object");for(i=Object(e),n=1;n<s;n++)if(a=arguments[n])for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r]);return i});var e={number:{normal:[[1,2,3],[4,5,6],[7,8,9],["backspace","0","enter"]]},name:{normal:[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["caps","z","x","c","v","b","n","m","backspace"],["&(ampersand)","-(hyphen)"," (space)",".(period)","â€™(apostrophe)","enter"]]},email:{normal:[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["caps","z","x","c","v","b","n","m","backspace"],["num","@(at)",".(period)","enter"]],num:[["1","2","3","4","5","6","7","8","9","0"],["$(dollar)","!(exclamation)","~(tilde)","&(ampersand)","=(equal)","#(number-sign)","[(square-bracket)","](square-bracket)"],["alt",".(period)","_(underscore)","-(hyphen)","+(plus)","backspace"],["normal","@(at)",".(period)","enter"]],alt:[["`(back-tick)","|(bar)","{(curly-bracket)","}(curly-bracket)","?(question)","%(percent)","^(circumflex)","*(asterisk)","/(forward-slash)","'(straight-quote)"],["$(dollar)","!(exclamation)","~(tilde)","&(ampersand)","=(equal)","#(number-sign)","[(square-bracket)","](square-bracket)"],["num",".(period)","_(underscore)","-(hyphen)","+(plus)","backspace"],["normal","@(at)",".(period)","enter"]]}},t={getElement:function(e){return!e instanceof HTMLElement?d.querySelector(e):e},wrap:function(e,t){var i=e.parentNode,n=document.createElement("div");return n.className=t,n.appendChild(i.removeChild(e)),i.appendChild(n)},isFn:function(e){return"function"==typeof e},addEvent:function(e,t,i){return e.addEventListener(t,i,!0),{el:e,fn:i,evt:"click"}}},i={on:function(e,t){return this._userHandlers[e]=t,this},_trigger:function(e,i){var n=this._userHandlers[e];return!n||!t.isFn(n)||!!n.call(this,i||this.current)},_bindKeys:function(e){var i=this;return t.addEvent(e,"click",function(e){var n=e.target?e.target.getAttribute("data-value"):null;if(e.stopPropagation(),null!==n)return t.isFn(i[n])?i[n](e,n):void(i._trigger(n)&&i.appendValue(n))})},_bindFocus:function(e){var i=this,n=[],a=function(){i.getField()!==this&&i.switchField(this),i.show()};return e.forEach(function(e){n.push(t.addEvent(e,"focusin",a))}),n}},n=document,a={root:null,field:null,keyboard:"email",layout:"normal"};function r(e){var i=Array.prototype.slice.call(n.querySelectorAll("input.pad-field")),r=e.field?t.getElement(e.field):i[0];this._o=e=Object.assign({},a,e||{}),this._dom={fields:i,root:e.root?t.getElement(e.root):t.wrap(i[0],"pad-wrap"),pad:this._createPadElement()},this._setState(r,e.keyboard,e.layout),this._render(),this._userHandlers=[],this._domHandlers=this._bindFocus(i),this._domHandlers.push(this._bindKeys(this._dom.root))}return r.addKeyboard=function(t,i,n){e[t]=i,r.prototype=Object.assign(r.prototype,n)},r.prototype=Object.assign({},{isModifierKey:function(e){return e.length>1},backspace:function(){this.setFieldValue(this.current.slice(0,-1))},caps:function(e){this.toggleUpperCase(this.toggleKey(e.target))},toggleUpperCase:function(e){this._setPadClassName("pad-upper",this.isUpper=e)},toggleKey:function(e){return e.classList.toggle("active")},num:function(e,t){this._changeLayout(e.target,t)},normal:function(e,t){this._changeLayout(e.target,t)},alt:function(e,t){this._changeLayout(e.target,t)},close:function(){this.hide()},next:function(){var e=this.getNextField();this.switchField(e)}},i,{switchField:function(e,t,i){return i=i||"normal",t=t||e.getAttribute("data-pad")||e.type||a.keyboard,this._setState(e,t,i),this._render(),this.show(),this},_setState:function(e,t,i){this._dom.field&&this._dom.field.classList.remove("pad-active"),e.classList.add("pad-active"),this._dom.field=e,this.keyboard=t,this.layout=i,this.current=this.getFieldValue(),this.fieldIdx=this._dom.fields.indexOf(e)},_getKeyboard:function(t){return e[t]},_setPadClassName:function(e,t){this._dom.pad.classList[t?"add":"remove"](e)},_changeLayout:function(e,t){this.layout=this.toggleKey(e)?t:"normal",this.toggleUpperCase(!1),this._render()},_render:function(){var e=this,t=e._dom.pad,i="";return e._getKeyboard(e.keyboard)[e.layout].forEach(function(t){i+='<div class="pad-row">',t.forEach(function(t){i+=t?e._createKey(t):e._createKeySpacer()}),i+="</div>"}),t.innerHTML=i,t.parentNode||e._dom.root.appendChild(t),t},_createPadElement:function(){var e=n.createElement("div");return e.className="pad-main",e},_createKeySpacer:function(){return'<span class="pad-space"></span>'},_createKey:function(e){var t=this._getKeyAttributes(e);return"<div "+('class="pad-key pad-key-'+t.name+(t.mod?" pad-key-modifier":"")+'"')+' aria-label="'+t.name+'" data-value="'+t.value+'">'+(t.mod?"":t.value)+"</div>"},_getKeyAttributes:function(e){var t=e.toString().match(/\(.+\)??$/);return t?(t=t.pop(),{value:e=e.replace(t,""),name:t.replace(/[()]/g,""),mod:this.isModifierKey(e)}):{value:e,name:e,mod:this.isModifierKey(e)}},getField:function(){return this._dom.field},getNextField:function(){var e=++this.fieldIdx;return e=e>=this._dom.fields.length?0:e,this._dom.fields[e]},appendValue:function(e){var t=this.getFieldValue();this.isUpper&&(e=e.toUpperCase()),this.setFieldValue(t+e)},getFieldValue:function(){return this._dom.field.value},setFieldValue:function(e){this._trigger("update",e)&&(this._dom.field.value=this.current=e)},clear:function(){this.setFieldValue("")},show:function(){this._dom.pad.style.display="block"},hide:function(){this._dom.pad.style.display="none"},destroy:function(e){e&&this.clear(),this.hide(),this._dom.root.removeChild(this._dom.pad),this._domHandlers.forEach(function(e){e.el.removeEventListener(e.evt,e.fn,!0)}),this._domHandlers=this._userHandlers=[],this._dom=this._o=null}}),r});
