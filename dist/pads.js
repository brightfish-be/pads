!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.pads=e()}(this,function(){"use strict";var t={layouts:{dial:{normal:[[1,2,3,4,5,6,7,8,9,0],["backspace","enter","close"]]},email:{normal:[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["caps","z","x","c","v","b","n","m","backspace"],["num","@",".","enter"]],num:[["1","2","3","4","5","6","7","8","9","0"],["$","!","~","&","=","#","[","]"],["alt",".","_","-","+","backspace"],["normal","@",".","enter"]],alt:[["`","|","{","}","?","%","^","*","/","'"],["$","!","~","&","=","#","[","]"],["num",".","_","-","+","backspace"],["normal","@",".","enter"]]},full:null},getKeyboard:function(t){switch(t){case"dial":return this.layouts.dial;case"email":return this.layouts.email;default:return this.layouts.full}},wrap:function(t,e){var i=t.parentNode,n=document.createElement("div");return n.className=e,n.appendChild(i.removeChild(t)),i.appendChild(n)},isFn:function(t){return"function"==typeof t}},e=document,i={field:".pad-field",minLength:1,maxLength:10,fnKeys:[{name:"backspace",text:"&#9003;"},{name:"enter",text:"&#8629;"},{name:"close",text:"&#215;"}],onUpdate:null,onEnter:null,onError:null,onClose:null};function n(n){this._o=Object.assign({},i,n=n||{}),this.dom={field:n.field="string"==typeof this._o.field?e.querySelector(this._o.field):this._o.field,root:n.root=n.root?n.root:t.wrap(n.field,"pad-wrap")},this.dom.pad=this._padElement(n.root),this.current=this.getFieldValue(),this.type=n.layout||"normal",this.render(),this.handlers=[this._bindFocus(this.dom.field),this._bindPad(this.dom.root)]}function r(e){e=Object.assign({keyboard:t.getKeyboard("email"),field:".pad-field-key"},e||{}),n.call(this,e)}function s(e){(e=e||{}).keyboard=e.keyboard||t.getKeyboard("dial"),e.field=e.field||".pad-field-num",n.call(this,e)}return n.prototype={setLayout:function(t){return this.type=t,this},setUpperCase:function(t){return this.setPadClassName("pad-upper",this.isUpper=t),this},toggleKey:function(t){return t.classList.toggle("active")},setPadClassName:function(t,e){return this._padElement().classList[e?"add":"remove"](t),this},changeLayout:function(t,e){this.setUpperCase(!1).setLayout(this.toggleKey(t)?e:"normal").render()},render:function(){var t=this,e=this._padElement(),i="";return this._o.keyboard[this.type].forEach(function(e){i+='<div class="pad-row">',e.forEach(function(e){i+=e?t._key(e,t.isModifierKey(e)):t._keySpacer()}),i+="</div>"}),e.innerHTML=i,e.parentNode||this.dom.root.appendChild(e),e},_padElement:function(){if(this.dom.pad)return this.dom.pad;var t=e.createElement("div");return t.className="pad-keys",t},_keySpacer:function(){return'<span class="pad-space"></span>'},_key:function(t,e){return"<div "+('class="key key-'+t+'"')+' aria-label="'+t+'">'+(e?"":t)+"</div>"},_bindPad:function(e){var i=this,n=function(e){var n=e.target?e.target.getAttribute("aria-label"):null;if(n){if(t.isFn(i[n]))return i[n](e,n);i.setValue(n),e.stopPropagation()}}.bind(i);return e.addEventListener("click",n,!1),{el:e,fn:n,evt:"click"}},_bindFocus:function(t){var e=this,i=function(){e.show()}.bind(e);return t.addEventListener("focusin",i,!1),{el:t,fn:i,evt:"click"}},setValue:function(t){var e=this.getFieldValue();this.validate(e+t)&&(this.isUpper&&(t=t.toUpperCase()),this.setField(e+t))},validate:function(t){return t.length<this._o.minLength?(this._fireCB("Error","The input value is too short."),!1):!(t.length>this._o.maxLength)||(this._fireCB("Error","The input value is too long."),!1)},isModifierKey:function(e){return t.isFn(this[e])},getFieldValue:function(){return this.dom.field.value},setField:function(t){return this.dom.field.value=this.current=t.toString(),this._fireCB("Update")},backspace:function(){this.setField(this.current.slice(0,-1))},clear:function(){return this.setField("")},close:function(){return this.hide().clear()._fireCB("Close"),this},enter:function(){this.validate(this.current)&&this._fireCB("Enter")},_fireCB:function(e,i){return(e=this._o["on"+e])&&t.isFn(e)&&e.call(this,i||this.current,this),this},show:function(){return this.dom.pad.style.display="block",this},hide:function(){return this.dom.pad.style.display="none",this},destroy:function(){var t=0,e=this.handlers.length;for(this.close(),this.dom.root.removeChild(this.dom.pad);t<e;t++)this.handlers[t].el.removeEventListener(this.handlers[t].evt,this.handlers[t].fn,!1);this.handlers=[],this.dom=this._o=null}},r.prototype=Object.assign(Object.create(n.prototype),{caps:function(t){this.setUpperCase(this.toggleKey(t.target))},num:function(t,e){this.changeLayout(t.target,e)},normal:function(t,e){this.changeLayout(t.target,e)},alt:function(t,e){this.changeLayout(t.target,e)}}),r.prototype.constructor=r,s.prototype=Object.create(n.prototype),s.prototype.constructor=s,{KeyPad:r,NumPad:s}});
